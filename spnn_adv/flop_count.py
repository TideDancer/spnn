######### vgg15 ########
total_flops = 705810432

flops_list = [  2752512, 
                85032960, 
                42516480, 
                84983808,
                42491904,
                84959232,
                84959232,
                42479616,
                84946944,
                84946944,
                21236736,
                21236736,
                21236736,
                589824]

orig_list = [   96, 96, 192,192,384,384,384,768,768,768,768,768,768,768 ]

sparse_list = [ 37, 56, 117,136,274,192,40,  3,  1,  2,  1,  2,  8,  4  ] 
#sparse_list = [77,74,161,146,254,125,26,78,66,9,47,55,54,237]
#sparse_list = [96,77,190,146,254,126,26,79,70,9,71,82,79,49]
#sparse_list = [96,78,191,146,254,126,27,79,74,9,137,100,416,479]


# ############### vgg 10 ###########
# total_flops = 314695680
# flops_list = [  1835008,
#                 37814272,
#                 18907136,
#                 37781504,
#                 18890752,
#                 37765120,
#                 37765120,
#                 18882560,
#                 37756928,
#                 37756928,
#                 9439232,
#                 9439232,
#                 9439232,
#                 262144 ]
# orig_list = list(map(lambda e: e/1.5, orig_list))
# 
# sparse_list = [24,48,91,96,193,179,82,40,4,2,3,3,4,7]
# #sparse_list = [32,38,86,86,155,149,100,150,3,2,2,2,18,12]
# #sparse_list = [44,54,92,115,234,155,31,76,55,9,34,35,21,280]
# #sparse_list = [64,62,128,126,234,155,31,79,73,9,59,73,56,27]
# #sparse_list = [64,62,128,126,234,155,31,81,76,9,138,101,413,373]


# ########################### res20 ###################
# total_flops = 41216512
# flops_list = [  2359296,
#                 2359296,
#                 2359296,
#                 2359296,
#                 2359296,
#                 2359296,
#                 1179648,
#                 2359296,
#                 2359296,
#                 2359296,
#                 2359296,
#                 2359296,
#                 1179648,
#                 2359296,
#                 2359296,
#                 2359296,
#                 2359296,
#                 2359296 ]
# 
# orig_list = [16,16,16,16,16,16,32,32,32,32,32,32,64,64,64,64,64,64]
# sparse_list = [12,12,6,6,11,11,32,32,28,28,28,28,47,47,34,34,25,25]
# #sparse_list = [1,2,1,1,12,10,11,16,20,16,14,15,52,56,47,35,51,18]

#############################################################3
remaining = total_flops - sum(flops_list)
pruned_flops = []
for i in range(len(orig_list)):
    pruned_flops.append(sparse_list[i]/orig_list[i]*flops_list[i])

ratio = total_flops/(sum(pruned_flops)+remaining)
print(ratio)
